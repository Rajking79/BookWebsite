<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Page</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

</head>
<body>

    <div class="container">

        <div class="row">

            <div class="col-sm-3"></div>
            <div class="col-sm-6">

                <div class="card w-100">
                    <div class="card-header text-bg-primary">
                        <h4>Order Now</h4>
                    </div>
                    <div class="card-body">

                        <form id="orderform">

                            <div class="form-group">
                                <label>Enter Name</label>
                                <input type="text" id="name" class="form-control" required />       
                            </div>
                            <div class="form-group">
                                <label>Enter Mobile</label>
                                <input type="number" id="mobile" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>Enter Email</label>
                                <input type="email" id="email" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>Enter Amount</label>
                                <input type="number" id="amount" class="form-control" required />
                            </div>
                            <div class="form-group mt-3">
                                <button class="btn btn-primary">Pay Now</button>
                            </div>

                        </form>

                    </div>
                </div>

            </div>

        </div>
        
    </div>

    
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <script>
        
        $(document).ready(function(){

            $("#orderform").submit(function(e){
                e.preventDefault();

                var amt = $("#amount").val();

                $.ajax({
                    url: "https://phpcrud.himanshukashyap.com/rzp/createOrder.php?amount="+amt,     
                    type: "get",
                    error: function(){
                        alert("Error in Ajax");
                    },
                    success: function(data){
                        
                        var token = data.token;
                        var key = data.key;

                        // Configure all parameters for payment
                        var options = {
                            "key": key,
                            "amount": amt*100,
                            "currency": "INR",
                            "name": "DigiCoders Technologies",
                            "description": "Test Transaction",
                            "image": "https://phpcrud.himanshukashyap.com/rzp/logo.jpg",
                            "order_id": token,
                            "callback_url": "https://eneqd3r9zrjok.x.pipedream.net/",
                            "prefill": {
                                "name": $("#name").val(),
                                "email": $("#email").val(),
                                "contact": $("#mobile").val()
                            },
                            "notes": {
                                "address": "DigiCoders Technologies Private Limited, Lucknow, UP"
                            },
                            "theme": {
                                "color": "#3399cc"
                            }, 

                            // Handle Success Response
                            "handler": function(response) {
                                alert("Payment Success");
                                window.location.href="success.html";
                            }
                        };

                        // Initialize Razorpay SDK
                        var rzp1 = new Razorpay(options);

                        // Open Razorpay
                        rzp1.open();


                        // Handle Payment Fail Response
                        rzp1.on('payment.failed', function (response){
                            alert("Payment Failed");
                            window.location.href="failed.html";
                        });

                    }
                });

            } );

        });

    </script>

</body>
</html>
